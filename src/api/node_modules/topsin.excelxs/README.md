[TOC]

# topsin.excelxs - 跨平台Excel操作库

**topsin.excel**是一个跨平台excel文件操作库。

使用的方式是通过引用返回的Book对象，添加Sheet,Format,Font对象，而不是自己定义这些对象。

```
var book = require('topsin.excelxs')
if(book.create('test.xlsx')) {
	var sheet = book.addSheet('template')
	var format = book.addFormat()
	var font = book.addFont()
	
	font.setName('Arial')
	font.setPointSize(20)
	font.setColor('#FF0000')
	
	format.setFont(font)
	format.setBorder('SOLID','BOTTOM')
	sheet.setCellValue(1,1,'test','string',format)
	
	book.save()
	book.saveAs('test2.xlsx')
}

book.close()
```

## 引用
**require('topsin.excelxs')**
返回为一个Book对象。

## 方法
### `Book` class
#### getError()
获取可能的错误信息，没有错误时，返回为空。

**参数**

**返回**
- `string`: 错误内容，为英文。

#### create(fileName)
创建新的工作簿；如果之前已经打开了一个工作簿，则会被关闭，且会丢失没有保存的内容。
**参数**
- fileName `string`: 文件名。

**返回**
- `bool`: 是否创建成功。

#### open(fileName [,sheetIndex] [,firstRow] [,lastRow])
打开一个存在的工作簿；如果之前已经打开了，则会被关闭，且会丢失未保存内容。
**参数**
- fileName `string`: 打开文件的名称。
- [sheetIndex = -1] `number`: 部分加载时，指定加载的表的索引。
- [firstRow = 0] `number`: 部分加载时，指定加载的第一行。
- [lastRow = -1] `number`: 部分加载时，指定加载的最后一行。

**返回**
- `bool`: 是否打开成功。

#### close()
关闭当前打开的文件，未保存的内容会丢失。
**参数**
**返回**

#### save()
保存当前文件。
**参数**
**返回**
- `bool`: 是否保存的成功。

#### saveAs(dstFileName)
文件另存为。
**参数**
- dstFileName `string`: 另存为文件的名称。

**返回**
- `bool`: 是否成功。

#### setTemplate(tmpl)
将打开的工作簿设置为模板，则可以保存为xlsx或者xls格式。但是一种格式的模板保存为另一种格式，会有警告。
**参数**
- [tmpl = true] `bool`: 是否这是为模板。

**返回**

#### isTemplate()
当前文件是否设置为了模板。
**参数**
**返回**
- `bool`: 是否是模板。

#### addSheet(sheetName [,otherSheet])
为当前工作簿添加新表。指定了*otherSheet*后可复制已存在的表。
**参数**
- sheetName `string`: 新表的名称。
- [otherSheet = null] `Sheet`: 指定其他已经存在的表，用于复制。 

**返回**
- `Sheet`: 添加的新表。
** 示例
```
var book = require('topsin.excelxs')
book.create('test.xlsx')
var sheet = book.addSheet('first')
var sheet2 = book.addSheet('second',sheet)
```
#### insertSheet(index [,sheetName] [,otherSheet])
在指定索引位置处插入新表。如果指定了*otherSheet*则表示复制该表到指定索引位置。

**注意：** *index*的范围为[0,sheetCount]；*index*等于sheetCount时，表示插入到最后的位置。

**参数**
- index `number`: 插入位置。
- sheetName `string`: 新表名称。 
- [otherSheet = null] `Sheet`: 要拷贝的表。

**返回**
- `Sheet`: 新表。

#### moveSheet(fromIndex, toIndex)
通过索引移动表格。

**注意：** *fromIndex*的范围是[0，sheetCount-1]，*toIndex*的范围是[0,sheetCount]。

**参数**
- fromIndex `number`: 表的原位置索引。
- toIndex `number`: 新位置索引。

**返回**
- `bool`: 是否移动成功。

#### getSheet(index | sheetName)
通过索引或者名称获取表。
**参数**
index和sheetName参数任选其一。
- index `number`: 表的位置索引。
- sheetName `string`: 表的名称。

**返回**
- `Sheet`: 获取的表。

#### delSheet(index)
删除指定索引的表。
**参数**
index和sheetName参数任选其一。
- index `number`: 表的位置索引。

**返回**
- `bool`: 是否删除成功。

#### setActiveSheet(index)
设置当前表。
**参数**
- index `number`: 表的位置索引。

**返回**

#### getActiveSheet()
获取当前表。
**参数**
**返回**
- `Sheet`: 获取的表。

#### getSheetCount()
获取工作簿当前拥有的表的数量。
**参数**
**返回**
- `number`: 表的数量。

#### addFormat([otherFormat])
添加新的格式到工作簿。
**参数**
- [otherFormat=null] `Format`: 其他已存在的格式。

**返回**
- `Format`: 新格式。

#### getFormat(index)
通过索引获取格式。索引和格式关系按照添加格式时确定。
**参数**
- index `number`: 索引。

**返回**
- `Format`: 获取的格式。

#### getFormatCount()
获取工作簿中格式的数量。
**参数**
**返回**
- `number`: 数量。

#### addFont([otherFont])
添加字体格式到工作簿。
**参数**
- [otherFont=null] `Font`: 其他已存在的字体。

**返回**
- `Font`: 新的字体对象。

#### getFont(index)
通过索引获取字体。
**参数**
- index `number`: 索引。

**返回**
- `Font`: 字体对象。

#### setDefaultFont(fontName, fontSize)
设置工作簿默认字体格式。
**参数**
- fontName `string`: 字体名。
- fontSize `number`: 字体大小。

**返回**

#### getDefaultFont()
获取默认字体设置。
**参数**
**返回**
- `{}`

|属性|类型|默认值|说明|
|:-:|:-:|:-:|:-:|
|name|`string`|""|字体名称|
|pointSize|`number`|0|字体大小|

#### getFontCount()
获取工作簿设置的字体格式数量。
**参数**
**返回**
- `number`: 字体数量。

#### addPicture(const QString &fileName)
添加图片文件到工作簿。
**参数**
- fileName `string`: 图片文件名。

**返回**
- `number`: 图片索引。

---

### `Sheet`class
`Sheet`类是在excel操作中最重要的类。它实现对表格读写以及格式设置等功能。

#### isNull()
判断表格是否为空。用于判断该*Sheet*对象是否合法。
**参数**
**返回**
- `bool`

#### setSheetName(sheetName)
设置表格名称。
**参数**
- sheetName `string`: 表格名称。

**返回**

#### getSheetName()
获取表格名称。
**参数**
**返回**
- `string`

#### setRightToLeft([rightToLeft])
设置文本显示模式为从右到左。
**参数**
- [rightToLeft=true] `bool`
**返回**

#### isRightToLeft()
**参数**
**返回**
- `bool`

#### setHidden(hidden)
设置单元格隐藏。
**参数**
- hidden `string`: 隐藏选项。

*hidden*可选的值如下：
| 值           | 说明                           |
| ------------ | ------------------------------ |
| "VISIBLE"    | 可见                           |
| "HIDDEN"     | 隐藏，但在界面上可以设置为可见 |
| "VERYHIDDEN" | 影藏，不能在界面上设置为可见   |

**返回**

#### getHidden()
获取隐藏设置选项。
**参数**
**返回**
- `string`

#### setTopLeftView(row, col)
设置左上角可见第一个单元格。
**参数**
- row `number`
- col `number`
**返回**

#### getTopLeftView()
获取左上角第一个可见单元格。
**参数**
**返回**
- `{}`

|属性|类型|默认值|
|:-|:-|:-|
|'row'|`number`|0|
|'col'|`number`|0|

#### setAutoFitArea([rowFirst] [, colFirst] [, rowLast] [, colLast])
设置单元格自动适应内容大小。默认参数表示整个表都设置为自适应。
**参数**
- [rowFirst=0] `number`: 起始行
- [colFirst=0] `number`: 起始列
- [rowLast=-1] `number`: 结束行
- [colLast=-1] `number`: 结束列

**返回**

#### QVariantMap addrToRowCol(const QString &addr)
将“A1”或者"A1:C3"形式的单元格索引转换为行列格式。
**参数**
- addr `string`

**返回**
- `{}`

返回值为：
```js
// 值表示的是默认值
{
    rowFirst:-1,
    rowLast:-1, // 参数为"A1"形式时，该属性始终为-1
    colFirst:-1,
    colLast:-1, // 参数为"A1"形式时，该属性始终为-1
    rowRelative:true,
    colRelative:true
}
```

#### rowColToAddr(rowFirst, colFirst [, rowLast] [, colLast] [, rowRelative] [, colRelative])
将指定行列转换为"A1"或者"A1:C2"形式。
**参数**
- rowFirst `number`
- colFirst `number`
- [rowLast=-1] `number`
- [colLast=-1] `number`
- [rowRelative=true] `number`
- [colRelative=true] `number`

**返回**
- `string`

#### setTabColor(color)
设置表格条的颜色。
**参数**
- color `string`: 颜色。

**返回**

#### getCellType(row, col)
获取单元格类型。单元格类型不同，其写入的值表现形式也不同。
**参数**
- row `number`
- col `number`

**返回**
- `string`: 单元格类型。

|返回值|说明|
|:-|:-|
|'EMPTY'|表示单元格既没有格式也没有内容。|
|'NUMBER'|单元格内容为数字。|
|'STRING'|内容为字符串。|
|'BOOLEAN'|内容为布尔类型。写入后显示为字符串 *'TRUE'* 或者 *'FALSE'*，但是返回值为 *true* 或者 *false* 。|
|'BLANK'|内容为空，但是有格式。|
|'ERROR'|内容为错误信息。|

#### copyCell(srcRow, srcCol, dstRow, dstCol)
拷贝单元格。包括内容和格式。
**参数**
- srcRow `number`: 源单元格行。
- srcCol `number`: 源单元格列。
- dstRow `number`: 目的单元格行。
- dstCol `number`: 目的单元格列。

**返回**
- `bool`: 拷贝是否成功。

#### setCellFormat(row, col, format)
仅设置单元格格式。
**参数**
- row `number`
- col `number`
- format `Format`

**返回**

#### getCellFormat(row, col)
获取单元格的格式。
**参数**
- row `number`
- col `number`
**返回**
- `Format`

<div id="index-sheet-setCellValue"/>

#### setCellValue(row, col, value [, valueType] [, format])
设置单元格的值。
**参数**
- row `number`
- col `number`
- value `any`

*value*选项包括：

| 值        | 说明         |
| --------- | ------------ |
| 'STRING'  | 值是字符串   |
| 'NUMBER'  | 值是数字     |
| 'BOOLEAN' | 值是布尔类型 |
| 'BLANK' | |
| 'FORMULA' | 公式 |
| 'FORMULA_STR' | *{expr:'', value:''}* |
| 'FORMULA_BOOL' | *{expr:'', value:false}* |
| 'COMMENT' | *{comment:'', author:'', width:129, height:75}* |
| 'ERROR' | |

在未指定类型的情况下，可以判别"string"和"number"类型的值。如果是其他类型，则必须指明类型。

- [valueType=''] `string`
- [format=null] `Format`

**返回**

#### getCellValue(row, col [, valueType])
**参数**
- row `number`
- col `number`
- [valueType='']

**返回**
- `any`

#### setCellFormula(row, col, expr [, format])
该单元格的值由写入的公式确定。如：

```
sheet.setCellFormula(3,2,"SUM(A1:A2)");
```

表示(3,2)所在单元格的值是"A1"单元格和"A2"单元格值的和。

具体可用公式，参考excel的说明。
**参数**
- row `number`
- col `number`
- expr `string`
- format `Format`

**返回**
- `bool`: 是否设置成功。

#### getCellFormula(row,col)
如果存在，获取单元格设置的公式。
**参数**
- row `number`
- col `number`

**返回**
- `string`

#### isFormula(row, col)
判断单元格是否含有公式。
**参数**
- row `number`
- col `number`

**返回**
- `bool`

#### setCols(colFirst, colLast, width [, format] [, hidden])
设置列的格式。
**参数**
- colFirst `number`
- colLast `number`
- width `number`
- [format=null] `Format`
- [hidden=false] `bool`

**返回**
- `bool`

#### setRows(rowFirst, rowLast, height [, format] [, hidden])
设置行的格式。
**参数**
- rowFirst `number`
- rowLast `number`
- height `number`
- [format=null] `Format`
- [hidden=false] `bool`

**返回**
- `bool`

#### getColWidth(col)
获取列宽。
**参数**
- col `number`

**返回**
- `number`

#### getRowHeight(row)
获取行高。
**参数**
- row `number`

**返回**
- `number`

#### setColHidden(col [, hidden])
隐藏列。
**参数**
- col `number`
- [hidden=true] `bool`

**返回**
- `bool`

#### isColHidden(col)
判断列是否隐藏。
**参数**
- col `number`

**返回**
- `bool`

#### setRowHidden(row [, hidden])
隐藏行。
**参数**
- row `number`
- [hidden=true] `bool`

**返回**
- `bool`

#### isRowHidden(row)
判断行是否隐藏。
**参数**
- row `number`

**返回**
- `bool`

#### insertRows(rowFirst, rowLast)
插入行。
**参数**
- rowFirst `number`
- rowLast `number`

**返回**
- `bool`

#### insertCols(colFirst, colLast)
插入列。
**参数**
- colFirst `number`
- colLast `number`

**返回**
- `bool`

#### removeRows(rowFirst, rowLast)
移除行。
**参数**
- rowFirst `number`
- rowLast `number`

**返回**
- `bool`

#### removeCols(colFirst, colLast)
移除列。
**参数**
- colFirst `number`
- colLast `number`

**返回**
- `bool`

#### getFirstRow()
获取有内容的第一个行。
**参数**

**返回**
- `number`

#### getLastRow()
获取有内容的最后一行。
**参数**

**返回**
- `number`

#### getFirstCol()
获取有内容的第一列。
**参数**
**返回**
- `number`

#### getLastCol()
获取有内容的最后一列。
**参数**
**返回**
- `number`

#### groupRows(rowFirst, rowLast [, collapsed])
将行分组。
**参数**
- rowFirst `number`
- rowLast `number`
- [collapsed=true] `bool`

**返回**
- `bool`

#### groupCols(colFirst, rowLast [, collapsed])
将列分组。
**参数**
- colFirst `number`
- rowLast `number`
- [collapsed=true] `bool`

**返回**
- `bool`

#### setGroupSummaryBelow([below])
**参数**
- [below=true] `bool`

**返回**

#### isGroupSummaryBelow()
**参数**

**返回**
- `bool`

#### setGroupSummaryRight([right])
**参数**
- [right=true] `bool`

**返回**

#### isGroupSummaryRight()
**参数**
**返回**
- `bool`

#### showGridlines([show])
设置显示网格。
**参数**
- [show=true] `bool`

**返回**

#### isShowGridlines()
是否显示网格。
**参数**
**返回**
- `bool`

#### setMerge(rowFirst, rowLast, colFirst, colLast)
合并单元格。
**参数**
- rowFirst `number`
- rowLast `number`
- colFirst `number`
- colLast `number`

**返回**
- `bool`

#### getMerge(row, col)
获取指定单元格所在的合并区域。
**参数**
- row `number`
- col `number`

**返回**
- `{}`

#### delMerge(row, col)
删除指定单元格所在合并区域。
**参数**
- row `number`
- col `number`

**返回**
- `bool`

#### getMergeCount()
获取表格合并区域的数量。
**参数**
**返回**
- `number`

#### clear([rowFirst] [, rowLast] [, colFirst] [, colLast])
清除表格内容。
**参数**
- [rowFirst=0] `number`
- [rowLast=1048575] `number`
- [colFirst=0] `number`
- [colLast=16383] `number`

**返回**
- `bool`

#### addRange(rowFirst, rowLast, colFirst, colLast)
添加单元格范围。
**参数**
- rowFirst `number`
- rowLast `number`
- colFirst `number`
- colLast `number`

**返回**
- `Range`

#### copyRange(srcRange, dstRow, dstCol)
拷贝单元格范围。
**参数**
- srcRange `Range`
- dstRow `number`
- dstCol `number`

**返回**
- `Range`

#### setPicture(row, col, picId [, scale] [, offsetX] [, offsetY])
设置图片到指定位置。
**参数**
- row `number`
- col `number`
- picId `number`: 使用book.addPicture获取的索引。
- [scale=1.0] `number`
- [offsetX=0] `number`
- [offsetY=0] `number`

**返回**

#### setPicture2(row, col, picId [, width] [, height] [, offsetX] [, offsetY])
设置图片到指定位置的第二种方法。
**参数**
- row `number`
- col `number`
- picId `number`: 使用book.addPicture获取的索引。
- [width=-1] `number`
- [height=-1] `number`
- [offsetX=0] `number`
- [offsetY=0] `number`

**返回**

#### getPictureInfo(index)
获取指定图片的信息。
**参数**
- index `number`

**返回**
- `{}`

返回值内容为：
```js
{
    index:-1,
    rowTop:0,
    colLeft:0,
    rowBottom:0,
    colRight:0,
    width:0,
    height:0,
    offsetX:0,
    offsetY:0
}
```

#### getPictureCount()
获取表格中图片数量。
**参数**

**返回**
- `number`

### `Format`class
**Format**类用于设置单元格的格式。

#### setFont(font)
设置字体格式。
**参数**
- font `Font`

**返回**

#### getFont()
获取字体。
**参数**
**返回**
- `Font`

#### setNumFormat(numFormat)
设置数字的显示格式。
**参数**
- numFormat `string`

|选项|效果|
|:-|:-:|
| "GENERAL" | |
| "NUMBER" | 1000 |
| "NUMBER_D2" | 1000.00 |
| "NUMBER_SEP" | 100,000 |
| "NUMBER_SEP_D2" | 100,000.00 |
| "CURRENCY_NEGBRA" | (1000$) |
| "CURRENCY_NEGBRARED" | <p style="color:red">(1000$)</p> |
| "CURRENCY_D2_NEGBRA" | ($1000.00) |
| "CURRENCY_D2_NEGBRARED" | <p style="color:red">($1000.00)</p> |
| "PERCENT" | 75% |
| "PERCENT_D2" | 75.00% |
| "SCIENTIFIC_D2" | 10.00E+1 |
| "FRACTION_ONEDIG" | 10 1/2 |
| "FRACTION_TWODIG" | 10 23/95 |
| "DATE" | 3/11/2009 |
| "CUSTOM_D_MON_YY" | 11-Mar-09 |
| "CUSTOM_D_MON" | 11-Mar |
| "CUSTOM_MON_YY" | Mar-09 |
| "CUSTOM_HMM_AM" | 8:30 AM |
| "CUSTOM_HMMSS_AM" | 8:30:00 AM |
| "CUSTOM_HMM" | 8:30 |
| "CUSTOM_HMMSS" | 8:30:00 |
| "CUSTOM_MDYYYY_HMM" | 3/11/2009 8:30 |
| "NUMBER_SEP_NEGBRA" | (4,000) |
| "NUMBER_SEP_NEGBRARED" | <p style="color:red">(4,000)</p> |
| "NUMBER_D2_SEP_NEGBRA" | (4,000.00) |
| "NUMBER_D2_SEP_NEGBRARED" | <p style="color:red">(4,000.00)</p> |
| "ACCOUNT" | 5,000 |
| "ACCOUNTCUR" | $ 5,000 |
| "NUMFORMAT_ACCOUNT_D2" | 5,000.00 |
| "NUMFORMAT_ACCOUNT_D2_CUR" |$	5,000.00 |
| "NUMFORMAT_CUSTOM_MMSS" | 30:55 |
| "NUMFORMAT_CUSTOM_H0MMSS" | 20:30:55 |
| "NUMFORMAT_CUSTOM_MMSS0" | 30:55.0 |
| "NUMFORMAT_CUSTOM_000P0E_PLUS0" | 15.2E+3 |
| "NUMFORMAT_TEXT" | any text|

**返回**

#### getNumFormat()
获取数字显示格式。
**参数**
**返回**
- `string`

#### setAlignH(align)
设置水平对齐格式。
**参数**
- align `string`

|选项|说明|
|:-|:-|
|"GENERAL"||
|"LEFT"||
|"CENTER"||
|"RIGHT"||
|"FILL"||
|"JUSTIFY"||
|"MERGE"||
|"DISTRIBUTED"||

**返回**

#### getAlignH()
获取水平对齐方式。
**参数**
**返回**
- `string`

#### setAlignV(align)
设置垂直对齐方式。
**参数**
- align `string`

|选项|说明|
|:-|:-|
|"TOP"||
|"CENTER"||
|"BOTTOM"||
|"JUSTIFY"||
|"DISTRIBUTED"||

**返回**

#### getAlignV()
获取垂直对齐方式。
**参数**
**返回**
- `string`

#### setWrap([wrap])
设置内容是否自动换行，以适应单元格大小。
**参数**
- [wrap=true] `bool`

**返回**

#### isWraped()
**参数**
**返回**
- `bool`

#### setRotation(rotation)
设置内容旋转。
**参数**
- rotation `number`

```
0-90: 逆时针旋转。
91-180： 顺时针旋转。
255： 垂直显示。
```

**返回**
- `bool`

#### getRotation()
**参数**
**返回**
- `number`

#### setIndent(indent)
设置缩进。
**参数**
- indent `number`

**返回**

#### getIndent()
**参数**
**返回**
- `number`

#### setShrinkToFit([shrinkToFit])
调整内容大小，以适应单元格。
**参数**
- [shrinkToFit=true] `bool`

**返回**

#### isShrinkToFit()
**参数**
**返回**
- `bool`

#### setBorder(style [, edge])
**参数**
- style `string`

<div id="index-border-style"/>

|选项|说明|
|:-|:-|
|"NONE"||
|"THIN"||
|"MEDIUM"||
|"DASHED"||
|"DOTTED"||
|"THICK"||
|"HAIR"||
|"MEDIUMDASHED"||
|"DASHDOT"||
|"MEDIUMDASHDOT"||
|"DASHDOTDOT"||
|"MEDIUMDASHDOTDOT"||
|"SLANDASHDOT"||

- [edge='ALL'] `string`

|选项|说明|
|:-|:-|
|"ALL"||
|"TOP"||
|"BOTTOM"||
|"LEFT"||
|"RIGHT"||

**返回**

#### getBorder(edge)
获取指定边的边框设置。
**参数**
- edge `string`

**返回**
- `string`

#### setBorderColor(color [, edge])
设置边框颜色。
**参数**
- color `string`
- [edge="ALL"] `string`

**返回**

#### getBorderColor(edge)
获取指定边的边框颜色。
**参数**
- edge `string`

**返回**
- `string`

#### setBorderDiagnoal(border)
设置单元格斜线框。
**参数**
- border `string`

|选项|说明|
|:-|:-|
|"NONE"||
|"DOWN"||
|"UP"||
|"BOTH"||

**返回**

#### getBorderDiagnoal()
**参数**
**返回**
- `string`

#### setBorderDiagnoalStyle(style)
**参数**
- style `string`: 参考[Border Style](#index-border-style)

**返回**

#### getBorderDiagnoalStyle()
**参数**
**返回**
- `string`

#### setBorderDiagnoalColor(color)
**参数**
- color `string`

**返回**

#### getBorderDiagnoalColor()
**参数**
**返回**
- `string`

#### setFillPattern(pattern)
设置填充模式。
**参数**
- pattern `string`

|选项|效果|
|:-|:-|
| "NONE" | |
| "SOLID" | |
| "GRAY50" | |
| "GRAY75" | |
| "GRAY25" | |
| "HORSTRIPE" | |
| "VERSTRIPE" | |
| "REVDIAGSTRIPE" | |
| "DIAGSTRIPE" | |
| "DIAGCROSSHATCH" | |
| "THICKDIAGCROSSHATCH" | |
| "THINHORSTRIPE" | |
| "THINVERSTRIPE" | |
| "THINREVDIAGSTRIPE" | |
| "THINDIAGSTRIPE" | |
| "THINHORCROSSHATCH" | |
| "THINDIAGCROSSHATCH" | |
| "GRAY12P5" | |
| "GRAY6P25" | |

**返回**

#### getFillPattern()
**参数**
**返回**
- `string`

#### setPatternForegroundColor(color)
设置填充颜色。
**参数**
- color `string`

**返回**

#### getPatternForegroundColor()
**参数**
**返回**
- `string`

#### setPatternBackgroundColor(color)
**参数**
- color `string`

**返回**

#### getPatternBackgroundColor()
**参数**
**返回**
- `string`

#### setLocked([locked])
**参数**
- [locked=true] `bool`

**返回**

#### isLocked()
**参数**
**返回**
- `bool`

#### setHidden([hidden])
**参数**
- [hidden=true] `bool`

**返回**

#### isHidden()
**参数**
**返回**
- `bool`

### `Font`class
**Font**类是用于设置单元格中内容的字体格式的。
使用时不能直接创建一个 *Font* 对象，应当通过 *Book* 对象的 *addFont()* 方法来添加新的字体对象。示例如下：
```
 var font  = book.addFont()
 font.setName('微软雅黑')
 font.setPointSize(20)

 var font2 = book.addFont(font) // 复制font
 font2.setPointSize('Arial')
 font2.setcolor('#FF0000')

```

#### setName(fontName)
设置字体。
**参数**
- fontName `string`: 字体名称。

**返回**
- `bool`: 是否设置成功。

#### getName()
获取字体。
**参数**
**返回**
- `string`: 字体名称。

#### setPointSize(size)
设置字体大小。
**参数**
- size `number`: 字体大小。

**返回**

#### getPointSize()
获取字体大小。
**参数**
**返回**
- `number`: 字体大小。

#### setItalic([italic])
设置为斜体。
**参数**
- [italic=true] `bool`: 是否为斜体。

**返回**

#### isItalic()
判断是否为斜体。
**参数**
**返回**
- `bool`: 是否为斜体。

#### setStrikeOut([strikeOut])
设置字体轮廓。
**参数**
- [strikeOut=true] `bool`: 是否字体轮廓。

**返回**

#### isStrikeOut()
判断是否有字体轮廓。
**参数**
**返回**
- `bool`: 是否有字体轮廓。

#### setColor(color)
设置字体颜色。颜色值建议使用[颜色表](#index-color-sheet)中的值。不在该表中的颜色值可能不支持。
**参数**
- color `string`: 颜色值，如 '#FF0000'。

**返回**

#### QString getColor()
获取字体颜色。
**参数**
**返回**
- `string`: 颜色值。

#### setBold([bold])
设置字体为粗体。
**参数**
- [bold=true] `bool`: 是否为粗体。

**返回**

#### isBold()
判断字体是否为粗体。
**参数**
**返回**
- `bool`: 粗体？

#### setScript(script)
设置字体上标/小标格式。如上标 3.14<sup>2</sup>，或者下标 1<sub>2</sub>。
**参数**
- script `string`: 

|值|说明|
|:-:|:-:|
|"NORMAL"|普通|
|"SUPER"|上标|
|"SUB"|下标|

**返回**

#### QString getScript()
**参数**
**返回**
- `string`

|值|说明|
|:-:|:-:|
|"NORMAL"|普通|
|"SUPER"|上标|
|"SUB"|下标|

#### setUnderline(underline)
设置下划线。
**参数**
- underline `string`: 下划线类型。

|值|说明|
|:-|:-|
|||

<p style="color:red">未完成!!</p>

**返回**


#### getUnderline()
获取下划线类型。
**参数**
**返回**
- `string`: 下划线类型。

### `Range`class
`Range`类用于对单元格进行批量操作。

#### isNull()
判断单元格是否为空。如果 *Range* 的范围无效则为空。
**参数**
**返回**
- `bool`

#### setMerge([merge])
合并该*Range*的单元格。
**参数**
- [merge=true] `bool`: 是否合并单元格。

**返回**
- `bool`: 设置是否成功。

#### isMerged()
判断是否合并。
**参数**
**返回**
- `bool`

#### setValue(value [, valueType] [, format])
设置值。在未合并状态下，该 *Range* 中的所有单元格都将写入相同内容和格式。
**参数**
- value `any`: 值。
- [valueType=''] `string`: 用于显式指定值的类型。可用的类型选项参考[Sheet::setCellValue](#index-sheet-setCellValue)。
- [format=null] `Format`: 指定格式。

**返回**

#### getValue([valueType])
获取值。
**参数**
- [valueType=''] `string`: 用于显式指定值的类型。可用的类型选项参考[Sheet::setCellValue](#index-sheet-setCellValue)。

**返回**
- `any`

#### setFormat(format)
设置 *Range* 的格式。
**参数**
- format `Format`

**返回**

#### getFormat()
获取 *Range* 格式。
**参数**

**返回**
- `Format`

<div id="index-color-sheet"/>
### 颜色表

![](http://doc.topibd.net/uploads/topjs/colors_1.png) ![](http://doc.topibd.net/uploads/topjs/colors_2.png) ![](http://doc.topibd.net/uploads/topjs/colors_3.png)


## 版本履历
#### V1.1.0 2019-03-22
. 兼容TopJS3.1.0;

#### V1.0.0 2018-10-18
. 初次发布;
