[TOC]

# topsin.mail - 邮件处理
`topsin.mail` 主要用于邮件处理;下面是一个示例；
```
var mail = require('topsin.mail');
var err = mail.sendMail({
    host:'smtp.163.com',
    auth_method:mail.AuthMethod.LOGIN,
    connection_type:mail.ConnectionType.TCP,
    from:'tony_gm@163.com',
    password:'mailpassword',
    to:'tony.guo@topibd.com',
    subject:'topjs mail test title',
    content:'topjs mail test body18',
    attachment:['Y:/Downloads/test.pdf']
});

if (err.isValid()) {
    print(err.text());
}
```

##方法

### sendMail(iParam)
发送邮件

**参数**
- **iCntParam** `Map<string,any>` : 发送邮件参数，结构如下

|  键 | 类型  |  必选 |  默认值 | 说明  |举例|
| :------------ | :------------ | :------------ | :------------ | :------------ |:------------|
|  host |  `string` | 是  |   | 邮件服务器 |smtp.163.com|
|  port |  `string` |   |  25 | 邮件服务器端口|
|  user |  `string` |   |   | 邮箱登录帐号,不设置则与`from`一致|tony_gm@163.com|
|  password |  `string` |   |   | 邮箱登录被密码  |  |
|  auth_method |  `string` |   | NONE  | 密码验证方式,可能的值为`LOGIN`,`PLAIN`,`NTLM`,`CRAM-MD5`,`NONE`  | |
|  connection_type |  `string` |   |TCP   | 连接方式,可能的值为`TCP`,`SSL`,`TSL` |   |
|  connection_timeout |  `number` |   | 60000  | 连接超时时间(毫秒),默认为1分钟 |   |
|  response_timeout |  `number` |   |120000| 回复超时时间(毫秒),默认为2分钟 | .  |
|  from |  `string` |  是  | | 邮件发送者 | tony_gm@163.com  |
|  to | `Array<string>` | 是  || 邮件接收者| ['tony.guo@topibd.com'] |
|  cc |   `Array<string>` |   ||邮件抄送者|   |
|  bcc |   `Array<string>` |   ||邮件密送者|   |
|  subject |   `Array<string>` |   ||邮件主题|   |
|  content |   `Array<string>`|   ||邮件内容|   |
|  attachment |  ` Array<string>` |   ||邮件附件|  ['C:/test.pdf'] |

**返回**
	`ErrMsg` 返回错误消息
	
**示例**
```js
var err = mail.sendMail({
    host:'smtp.163.com',
    auth_method:mail.AuthMethod.LOGIN,
    connection_type:mail.ConnectionType.TCP,
    from:'tony_gm@163.com',
    password:'mailpassword',
    to:'tony.guo@topibd.com',
    subject:'topjs mail test title',
    content:'topjs mail test body18',
    attachment:['Y:/Downloads/test.pdf']
});
```

## 版本履历
#### V1.1.0 2019-03-22
. 兼容TopJS3.1.0;

#### V1.0.0 2018-10-18
. 初次发布;
